<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>async与await</title>
</head>
<body>
  <script>

    /*
      1、async修饰的函数
            函数的返回值为promise对象
            promise实例的结果由async函数的执行返回值决定

      2、await表达式
            await右侧的表达式一般为Promise实例对象，但也可以是其他的值
            (1)、如果表达式是promise实例对象，await后的返回值是promise成功的值
            (2)、如果表达式是其他值，直接将此值作为await的返回值

      3、注意：
            await必须写在async函数中，但async函数中可以没有await
            如果await的promise实例对象失败了，就会抛出异常，需要通过try...catch来捕获异常

     */


    const p1 = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve('a')
      }, 1000)
    })

    const p2 = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve('b')
      }, 2000)
    });

    const p3 = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve('c')
      }, 4000)
    });

    // p.then(
    //   value => {
    //     console.log("成功了", value);
    //   },
    //   reason => {
    //     console.log("失败了", reason);
    //   }
    // )


    //如果只想拿到p 【成功！！！】的值，就可以借助 await
    //await只能在被async修饰的函数中使用，await的右侧可以是一个promise实例
    //await只能等到一个promise(成功！)的值

    // const result = await p
    // console.log(result);

    // async function demo() {
    //   try{
    //     const result = await p
    //     console.log(result);
    //   }catch(error){
    //     console.log(error);
    //   }
    // }
    // demo()


    //一般我们在写IIFE的时候，在最前面加上一个; 避免出问题
    // ;(async () => {
    //   try {
    //     const result1 = await p1
    //     console.log(result1);
    //     const result2 = await p2
    //     console.log(result2);
    //     const result3 = await p3
    //     console.log(result3);
    //   } catch (error) {
    //     console.log(error);
    //   }
    // })()


    //测试async
    async function fun() {
      //函数体
      // return Promise.reject(-100)

    }

    const result = fun()
    result.then(
      value => {
        console.log('ok', value);
      },
      reason => {
        console.log(reason);
      }
    )
    // console.log(result);

  </script>
</body>
</html>